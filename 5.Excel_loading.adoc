
:sectnums:

== EXCEL 로딩 ==
시스템에서 사용하는 주요 데이터들은 [EXCEL 로딩] 기능을  이용하여 시스템으로 업로드 할 수 있다. 상품 데이터, 매출 데이터 등이 그 예라고 할 수 있다. 본 장에서는 Excel 을 이용하여 다양한 데이터들을 업로드 하는 방법에 대하여 설명하겠다.

=== 상품 데이터 EXCEL ===
벤더에서 제공하는 상품 데이터들을 업로드 하는 방법에 대하여 설명한다. 상품 데이터를 업로드 하기 위해서는 프로그램에서 제공하는 템플릿 파일에 업로드할 상품 데이터의 정보를 입력하여야 한다.

==== 상품 데이터 템플릿 파일  ====
상품 데이터를 업로드하기 위한 템플릿 파일은 프로그램 설치 경로 아래  **template\product.xlsx** 이다.

image::images/product_template.gif[]

위의 파일을 열어보면 제품 정보를 업로드 하기 위한 컬럼 정보를 확인할 수 있다. 아래는 해당 컬럼 정보에 대한 설명이다.

.상품 데이터 템플릿 컬럼 설명
|===
|컬럼명 | 컬럼 설명 | 필수 여부
|vendor_id | 벤더 아이디 | O
|brand_id  | 해당 상품의 브랜드 아이디 | O
|reference | 벤더에서 부여한 상품 reference 번호 | O
|desc    | 상품 설명 | O
|discontinued | 단종여부(Y/N)| O
|retail_price | 상품 판매 가격 (숫자만 가능) | O
|kinds | 상품 종류 (saleable/posm/sample 만 가능) | O
|type | 상품 type | O
|category | 상품 category | O
|subcategory| 상품 subcategory | O
|invoice_price| 인보이스 가격(숫자만 가능) | X
|size | 상품 크기 | X
|eancode | 상품 eanode | x
|moq | 상품 moq | X
|packing_unit | 상품 포장 단위 | X
|barcode | 상품barode | X
|incoterm| incoterm |X
|origin| 상품 원산지 | X
|===

TIP: 해당 상품 컬럼 외에 추가로 입력해야 할 속성이 있는 경우, 기존 템플릿 파일에 컬럼을 추가하고 해당 속성 값을 입력하면, 프로그램에서 자동으로 해당 속성을 인식하여 업로드 한다.

image::images/add_prop.gif[]

TIP: 상품을 업로드 하는 과정에서 기존 존재하는 제품이 있으면 현재 Excel 에 있는 데이터를 기준으로 상품 데이터를 업데이트 하게 되고, 존재하는 제품이 아니면 새로 제품 정보를 생성한다.

위 그림을 보면 추가로 "color" 라는 제품 속성이 필요로 한 경우, "color" 라는 속성을 추가하고 값을 채워 넣은 것을 확인할 수 있다.

==== 상품 데이터 업로드 ====
상품 데이터 템플릿 파일에 제품 정보를 모두 입력한 후에는 시스템을 이용하여 해당 정보를 시스템에 업로드 하여야 한다. 업로드 하기 위해서 [EXCEL 로딩] -> [상품정보 EXCEL] 메뉴를 클릭한다.

===== 상품 데이터 Excel 파일 선택 =====

image::images/upload_product1.gif[]

. 찾기: 상품 Excel template 파일의 위치를 지정한다.
. 확인: template 파일 위치를 지정했으면 [확인] 버튼을 눌러서 Excel 파일 정보를 읽어 온다.
. 데이터 시트 지정 : [확인] 버튼을 누르면 [데이터 시트 ] 콤보 박스에 선택한 Excel 파일의 시트명이 보이게 된다. 해당 시트 중에서 업로드할 상품 정보가 존재하는 시트명을 선택한다.
. 미리보기 : Excel 시트를 선택한 후에는 [미리보기] 버튼을 클릭하여, 업로드할 상품 정보 데이터를 확인한다.

===== 상품 데이터 미리보기 =====
image::images/upload_product2.gif[]

[미리보기] 버튼을 클릭하면 입력한 상품 정보 데이터를 확인할 수 있다. 좌측에는 Excel 에 있는 컬럼 정보를, 우측에는 입력한 상품 데이터을 확인할 수 있다.

TIP: 일반적인 경우는 아니지만 만일, 특정 컬럼들만 선택해서 데이터를 업로드 하고 싶을 때에는 [컬럼 정보] 화면에서 원하는 컬럼을 선택하고, 하단의 [확인 ] 버튼을 클릭하면 선택한 컬럼 기준으로 상품 데이터를 업로드 하게 된다.

===== 데이터 검증 =====
상품 데이터는 업로드 하기 전에 데이터 검증 과정을 거치게 된다. 화면 하단의 [데이터 검증] 을 클릭하여 데이터 검증 과정을 수행한다. 이 과정에서 검증하는 항목은 아래와 같다.

.상품 데이터 검증 항목
|===
|검증 항목 | 설명
|Vendor 유효성 | 입력한 Vendor 아이디가 존재하는지 확인
|Brand 유효성  | 입력한 Brand 가 존재하는지 확인
|상품 종류 유효성 | 입력한 데이터가 saleable/posm/sample 이외의 값이 있는지 확인
|===

검증 과정에서 오류가 있으면 프로그램 화면에서 해당 오류를 확인할 수 있다.

image::images/product_verify_err.gif[]

검증 과정에서 문제가 없는 경우 데이터 검증에 성공했다는 메세지를 확인할 수 있다.

image::images/product_verify_ok.gif[]

===== 데이터 업로드 =====
검증 과정을 마쳤으면 하단의 [업로드] 버튼을 클릭하여, 데이터를 업로드 합니다.  성공적으로 업로드 되었으면 아래와 같은 메세지를 확인할 수 있다.

image::images/upload_product_success.gif[600,400]

업로드한 데이터를 확인하려면 [기준정보] -> [상품정보] 메뉴를 통하여, 해당 벤더를 선택하고 제품을 검색해서 정상적으로 상품 정보가 조회되는지 확인한다.

image::images/search_product.gif[]
